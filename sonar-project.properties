# SonarCloud Configuration for Stone Soup
# See: https://docs.sonarcloud.io/advanced-setup/analysis-parameters/

# Project identification
sonar.projectKey=montge_Stone-Soup
sonar.organization=montge
sonar.projectName=Stone Soup
sonar.projectVersion=1.0

# Source code configuration
sonar.sources=stonesoup,libstonesoup/src,bindings
sonar.tests=stonesoup,libstonesoup/tests,bindings
sonar.test.inclusions=**/test_*.py,**/tests/**/*,**/*_test.rs,**/*Test.java
sonar.sourceEncoding=UTF-8

# Python configuration
sonar.python.version=3.10,3.11,3.12,3.13,3.14
sonar.python.coverage.reportPaths=coverage.xml

# C/C++ configuration (libstonesoup)
# SonarCloud requires a compilation database for C/C++ analysis in manual mode.
# The CI workflow generates compile_commands.json using CMake.
sonar.cfamily.compile-commands=libstonesoup/build/compile_commands.json
sonar.cfamily.gcov.reportsPath=libstonesoup/build/gcov_reports

# Exclusions
sonar.exclusions=\
    **/node_modules/**,\
    **/venv/**,\
    **/.venv/**,\
    **/build/**,\
    **/dist/**,\
    **/*.min.js,\
    **/docs/**,\
    **/__pycache__/**,\
    **/.pytest_cache/**,\
    **/target/**,\
    **/bindings/nodejs/node_modules/**

# Test exclusions (don't analyze tests as production code)
sonar.coverage.exclusions=\
    **/test_*.py,\
    **/tests/**,\
    **/*_test.rs,\
    **/*Test.java,\
    **/conftest.py

# Duplication exclusions
sonar.cpd.exclusions=\
    **/test_*.py,\
    **/tests/**

# Rule exclusions for false positives
# S5890: Property descriptor pattern - SonarCloud doesn't understand that Property
#        is a descriptor that returns the typed value at runtime, not a Property instance.
#        This is a fundamental pattern in Stone Soup and affects all component classes.
sonar.issue.ignore.multicriteria=e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,e11,e12

# Ignore S5890 (type hint mismatch) for all Property declarations
# Stone Soup's Property descriptor returns typed values at runtime, not Property instances
sonar.issue.ignore.multicriteria.e1.ruleKey=python:S5890
sonar.issue.ignore.multicriteria.e1.resourceKey=**/*.py

# Ignore S117 (naming convention) for mathematical variable names
# These follow standard mathematical notation (e.g., F for state transition matrix)
sonar.issue.ignore.multicriteria.e2.ruleKey=python:S117
sonar.issue.ignore.multicriteria.e2.resourceKey=**/*.py

# Ignore S1244 (float equality) in test files - intentional for test assertions
sonar.issue.ignore.multicriteria.e3.ruleKey=python:S1244
sonar.issue.ignore.multicriteria.e3.resourceKey=**/test_*.py,**/tests/**

# Ignore S7498 (constructor vs literal) - stylistic preference, not a bug
# Many legitimate uses of list(), dict() for conversion from iterators
sonar.issue.ignore.multicriteria.e4.ruleKey=python:S7498
sonar.issue.ignore.multicriteria.e4.resourceKey=**/*.py

# Ignore S6711 (numpy.random.Generator) - legacy code uses np.random functions
# Changing would require significant refactoring with no functional benefit
sonar.issue.ignore.multicriteria.e5.ruleKey=python:S6711
sonar.issue.ignore.multicriteria.e5.resourceKey=**/*.py

# Ignore S1135 (TODO comments) - these are intentional markers for future work
sonar.issue.ignore.multicriteria.e6.ruleKey=python:S1135
sonar.issue.ignore.multicriteria.e6.resourceKey=**/*.py

# Ignore S905 (no side effects) - often used for demonstration in tutorials
sonar.issue.ignore.multicriteria.e7.ruleKey=python:S905
sonar.issue.ignore.multicriteria.e7.resourceKey=**/*.py

# Ignore S125 (commented code) - often used for educational examples and alternatives
sonar.issue.ignore.multicriteria.e8.ruleKey=python:S125
sonar.issue.ignore.multicriteria.e8.resourceKey=**/*.py

# Ignore S7500 (comprehension vs collection) - stylistic preference
sonar.issue.ignore.multicriteria.e9.ruleKey=python:S7500
sonar.issue.ignore.multicriteria.e9.resourceKey=**/*.py

# Ignore S1192 (duplicate strings) - many legitimate repeated strings in docs/messages
sonar.issue.ignore.multicriteria.e10.ruleKey=python:S1192
sonar.issue.ignore.multicriteria.e10.resourceKey=**/*.py

# Ignore S6729 (np.where vs np.nonzero) - stylistic preference
sonar.issue.ignore.multicriteria.e11.ruleKey=python:S6729
sonar.issue.ignore.multicriteria.e11.resourceKey=**/*.py

# Ignore S7494 - type annotation style preferences
sonar.issue.ignore.multicriteria.e12.ruleKey=python:S7494
sonar.issue.ignore.multicriteria.e12.resourceKey=**/*.py

# Quality gate settings (enforced via SonarCloud UI)
# These are documented here for reference:
# - Overall coverage: >= 90%
# - Branch coverage: >= 80%
# - New code coverage: >= 95%
# - Duplicated lines: < 3%
# - Maintainability rating: A
# - Security rating: A
# - Reliability rating: A

# Language-specific settings

# Java configuration
sonar.java.source=22
sonar.java.binaries=bindings/java/target/classes
sonar.java.coveragePlugin=jacoco
sonar.coverage.jacoco.xmlReportPaths=bindings/java/target/site/jacoco/jacoco.xml

# JavaScript/TypeScript configuration (Node.js bindings)
sonar.javascript.lcov.reportPaths=bindings/nodejs/coverage/lcov.info

# Go configuration
# Note: SonarCloud supports Go analysis but coverage via LCOV
sonar.go.coverage.reportPaths=bindings/go/lcov.info

# C++ bindings coverage (separate from C library)
# Uses the same gcov format as the C library
# Note: C++ headers in bindings/cpp are analyzed with the cfamily plugin

# Rust analysis
# Note: SonarCloud does not natively support Rust analysis.
# Rust coverage is tracked separately via Codecov.
# The LCOV report is generated but used for Codecov, not SonarCloud.
# sonar.rust.coverage.reportPaths=bindings/rust/lcov.info
